// Tencent is pleased to support the open source community by making
// 蓝鲸智云 - 监控平台 (BlueKing - Monitor) available.
// Copyright (C) 2022 THL A29 Limited, a Tencent company. All rights reserved.
// Licensed under the MIT License (the "License"); you may not use this file except in compliance with the License.
// You may obtain a copy of the License at http://opensource.org/licenses/MIT
// Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
// an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
// specific language governing permissions and limitations under the License.

package etl_test

import (
	"testing"

	"github.com/TencentBlueKing/bkmonitor-datalink/pkg/transfer/define"
	"github.com/TencentBlueKing/bkmonitor-datalink/pkg/transfer/etl"
	"github.com/TencentBlueKing/bkmonitor-datalink/pkg/transfer/utils"
)

func newPayload() define.Payload {
	payload, err := define.NewPayload(utils.GetEnvOr("PAYLOAD", "json"), 0)
	if err != nil {
		panic(err)
	}
	return payload
}

func benchmarkMapContainerLoads(b *testing.B, data string) {
	b.ResetTimer()
	b.StopTimer()

	payload := newPayload()
	err := payload.From([]byte(data))
	if err != nil {
		panic(err)
	}

	for i := 0; i < b.N; i++ {
		container := etl.NewMapContainer()
		b.StartTimer()
		err = payload.To(&container)
		b.StopTimer()
		if err != nil {
			panic(err)
		}
	}
	b.StopTimer()
}

func benchmarkStructureLoads(b *testing.B, data string, structure interface{}) {
	b.ResetTimer()
	b.StopTimer()

	payload := newPayload()
	err := payload.From([]byte(data))
	if err != nil {
		panic(err)
	}

	for i := 0; i < b.N; i++ {
		b.StartTimer()
		err = payload.To(structure)
		b.StopTimer()
		if err != nil {
			panic(err)
		}
	}
	b.StopTimer()
}

func benchmarkMapContainerDumps(b *testing.B, data string) {
	b.ResetTimer()
	b.StopTimer()

	payload := newPayload()
	err := payload.From([]byte(data))
	if err != nil {
		panic(err)
	}
	container := etl.NewMapContainer()
	err = payload.To(&container)
	if err != nil {
		panic(err)
	}

	for i := 0; i < b.N; i++ {
		payload := newPayload()
		b.StartTimer()
		err := payload.From(container)
		b.StopTimer()
		if err != nil {
			panic(err)
		}
	}
}

var (
	consulData   = `{"bkmonitorbeat":{"address":["127.0.0.1"],"hostname":"rbtnode1","name":"rbtnode1","version":"10.1.5"},"bizid":0,"cloudid":0,"data":{"city":"","country":"","cpu":{"cpuinfo":[{"cacheSize":4096,"coreId":"0","cores":1,"cpu":0,"family":"6","flags":["fpu","vme","de","pse","tsc","msr","pae","mce","cx8","apic","sep","mtrr","pge","mca","cmov","pat","pse36","clflush","mmx","fxsr","sse","sse2","ss","ht","syscall","nx","lm","constant_tsc","rep_good","nopl","eagerfpu","pni","pclmulqdq","ssse3","fma","cx16","pcid","sse4_1","sse4_2","x2apic","movbe","popcnt","tsc_deadline_timer","aes","xsave","avx","f16c","rdrand","hypervisor","lahf_lm","abm","3dnowprefetch","bmi1","avx2","bmi2","rdseed","adx","xsaveopt"],"mhz":2394.454,"microcode":"0x1","model":"79","modelName":"Intel(R) Xeon(R) CPU E5-26xx v4","physicalId":"0","stepping":1,"vendorId":"GenuineIntel"},{"cacheSize":4096,"coreId":"1","cores":1,"cpu":1,"family":"6","flags":["fpu","vme","de","pse","tsc","msr","pae","mce","cx8","apic","sep","mtrr","pge","mca","cmov","pat","pse36","clflush","mmx","fxsr","sse","sse2","ss","ht","syscall","nx","lm","constant_tsc","rep_good","nopl","eagerfpu","pni","pclmulqdq","ssse3","fma","cx16","pcid","sse4_1","sse4_2","x2apic","movbe","popcnt","tsc_deadline_timer","aes","xsave","avx","f16c","rdrand","hypervisor","lahf_lm","abm","3dnowprefetch","bmi1","avx2","bmi2","rdseed","adx","xsaveopt"],"mhz":2394.454,"microcode":"0x1","model":"79","modelName":"Intel(R) Xeon(R) CPU E5-26xx v4","physicalId":"0","stepping":1,"vendorId":"GenuineIntel"},{"cacheSize":4096,"coreId":"2","cores":1,"cpu":2,"family":"6","flags":["fpu","vme","de","pse","tsc","msr","pae","mce","cx8","apic","sep","mtrr","pge","mca","cmov","pat","pse36","clflush","mmx","fxsr","sse","sse2","ss","ht","syscall","nx","lm","constant_tsc","rep_good","nopl","eagerfpu","pni","pclmulqdq","ssse3","fma","cx16","pcid","sse4_1","sse4_2","x2apic","movbe","popcnt","tsc_deadline_timer","aes","xsave","avx","f16c","rdrand","hypervisor","lahf_lm","abm","3dnowprefetch","bmi1","avx2","bmi2","rdseed","adx","xsaveopt"],"mhz":2394.454,"microcode":"0x1","model":"79","modelName":"Intel(R) Xeon(R) CPU E5-26xx v4","physicalId":"0","stepping":1,"vendorId":"GenuineIntel"},{"cacheSize":4096,"coreId":"3","cores":1,"cpu":3,"family":"6","flags":["fpu","vme","de","pse","tsc","msr","pae","mce","cx8","apic","sep","mtrr","pge","mca","cmov","pat","pse36","clflush","mmx","fxsr","sse","sse2","ss","ht","syscall","nx","lm","constant_tsc","rep_good","nopl","eagerfpu","pni","pclmulqdq","ssse3","fma","cx16","pcid","sse4_1","sse4_2","x2apic","movbe","popcnt","tsc_deadline_timer","aes","xsave","avx","f16c","rdrand","hypervisor","lahf_lm","abm","3dnowprefetch","bmi1","avx2","bmi2","rdseed","adx","xsaveopt"],"mhz":2394.454,"microcode":"0x1","model":"79","modelName":"Intel(R) Xeon(R) CPU E5-26xx v4","physicalId":"0","stepping":1,"vendorId":"GenuineIntel"}],"per_stat":[{"cpu":"cpu0","guest":0,"guestNice":0,"idle":1874959.62,"iowait":1443.4,"irq":0,"nice":25.88,"softirq":21440.76,"steal":0,"stolen":0,"system":774181.42,"user":3621133.91},{"cpu":"cpu1","guest":0,"guestNice":0,"idle":1838332.3,"iowait":1550.54,"irq":0,"nice":27.2,"softirq":16968.66,"steal":0,"stolen":0,"system":770042.04,"user":3662370.58},{"cpu":"cpu2","guest":0,"guestNice":0,"idle":1677508.86,"iowait":1304.56,"irq":0,"nice":27.24,"softirq":15277.27,"steal":0,"stolen":0,"system":755156.01,"user":3830613.85},{"cpu":"cpu3","guest":0,"guestNice":0,"idle":1526240.55,"iowait":1188.03,"irq":0,"nice":28.89,"softirq":13434.86,"steal":0,"stolen":0,"system":748507.47,"user":3985733.29}],"per_usage":[57.52688171810826,58.720538722844616,58.807588077351326,60.61016949430361],"total_stat":{"cpu":"cpu-total","guest":0,"guestNice":0,"idle":6917041.35,"iowait":5486.55,"irq":0,"nice":109.22,"softirq":67121.57,"steal":0,"stolen":0,"system":3047886.95,"user":15099851.65},"total_usage":58.9406207838031},"datetime":"2019-01-04 12:08:20","disk":{"diskstat":{"vda1":{"avgqu_sz":0.027580761055024678,"avgrq_sz":38.31101956745623,"await":0.8522142121524202,"ioTime":26194174,"iopsInProgress":0,"major":253,"mergedReadCount":135145,"mergedWriteCount":208487755,"minor":1,"name":"vda1","readBytes":1676430307840,"readCount":24899897,"readSectors":3274277945,"readTime":61597448,"serialNumber":"","speedByteRead":195907.06235502337,"speedByteWrite":438913.7320358189,"speedIORead":0.5999440471183616,"speedIOWrite":31.76370427243325,"svctm":0.1678681771369722,"util":0.005432826648905163,"weightedIoTime":225439139,"writeBytes":2070945312768,"writeCount":153261901,"writeSectors":4044815064,"writeTime":163778722}},"partition":[{"device":"/dev/vda1","fstype":"ext4","mountpoint":"/","opts":"rw,noatime,data=ordered"}],"usage":[{"free":20511154176,"fstype":"ext2/ext3","inodesFree":3088747,"inodesTotal":3276800,"inodesUsed":188053,"inodesUsedPercent":5.738922119140625,"path":"/","total":52709400576,"used":29820047360,"usedPercent":56.57443840023076}]},"env":{"crontab":[{"content":"*/1 * * * * /usr/local/qcloud/stargate/admin/start.sh \u003e /dev/null 2\u003e\u00261 \u0026\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch rabbitmq \u003e/dev/null 2\u003e\u00261\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch nginx \u003e/dev/null 2\u003e\u00261\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch beanstalk \u003e/dev/null 2\u003e\u00261\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch tsdbproxy \u003e/dev/null 2\u003e\u00261\n\n\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch etcd \u003e/dev/null 2\u003e\u00261\n\n\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch influxdb \u003e/dev/null 2\u003e\u00261\n\n\n\n\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch consul \u003e/dev/null 2\u003e\u00261\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n* * * * * /usr/local/gse/agent/bin/gsectl watch\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch kafka \u003e/dev/null 2\u003e\u00261\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n*/10 * * * * /data/bkee/bkdata/dataapi/bin/update_cc_cache.sh\n\n# 定时删除Crate中的过期数据\n0 */1 * * * /data/bkee/bkdata/dataapi/datatools/scripts/crate_tool.sh\n\n# 定时删除ES中的过期数据\n0 */1 * * * /data/bkee/bkdata/dataapi/datatools/scripts/es_delete_expired_index.sh\n\n# 定时提前创建ES中的索引\n*/10 * * * * /data/bkee/bkdata/dataapi/datatools/scripts/es_create_mapping_ahead.sh\n* * * * * export INSTALL_PATH=/data/bkee; /data/bkee/bin/process_watch bkdata \u003e/dev/null 2\u003e\u00261\n","user":"root"}],"host":"# Your system has configured 'manage_etc_hosts' as True.\n# As a result, if you wish for changes to this file to persist\n# then you will need to either\n# a.) make changes to the master file in /etc/cloud/templates/hosts.redhat.tmpl\n# b.) change or remove the value of 'manage_etc_hosts' in\n#     /etc/cloud/cloud.cfg or cloud-config from user-data\n# \n# The following lines are desirable for IPv4 capable hosts\n127.0.0.1 VM_2_47_centos VM_2_47_centos\n127.0.0.1 localhost.localdomain localhost\n127.0.0.1 localhost4.localdomain4 localhost4\n\n# The following lines are desirable for IPv6 capable hosts\n::1 VM_2_47_centos VM_2_47_centos\n::1 localhost.localdomain localhost\n::1 localhost6.localdomain6 localhost6\n\n127.0.0.1   nginx-1\n127.0.0.1   rbtnode1\n127.0.0.1 paasee-y.o.qcloud.com\n127.0.0.1 cmdbee-y.o.qcloud.com\n127.0.0.1 jobsee-y.o.qcloud.com\n","route":"Kernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         10.0.0.1        0.0.0.0         UG    0      0        0 eth0\n10.0.0.2        0.0.0.0         255.255.255.0   U     0      0        0 eth0\n169.254.0.0     0.0.0.0         255.255.0.0     U     1002   0        0 eth0\n"},"load":{"load_avg":{"load1":6.64,"load15":10.94,"load5":10.7}},"mem":{"meminfo":{"active":12080185344,"available":4764487680,"buffers":152883200,"cached":2050084864,"dirty":2740224,"free":2748784640,"inactive":1408921600,"total":16658251776,"used":11893764096,"usedPercent":71.39863327756682,"wired":0,"writeback":0,"writebacktmp":0},"vmstat":null},"net":{"dev":[{"bytesRecv":1318453103391,"bytesSent":388623750269,"dropin":0,"dropout":0,"errin":0,"errout":0,"fifoin":0,"fifoout":0,"name":"eth0","packetsRecv":2557897586,"packetsSent":2281184688,"speedPacketsRecv":2267,"speedPacketsSent":1104,"speedRecv":2542222,"speedSent":148260},{"bytesRecv":1353549908006,"bytesSent":1353549908006,"dropin":0,"dropout":0,"errin":0,"errout":0,"fifoin":0,"fifoout":0,"name":"lo","packetsRecv":12595614280,"packetsSent":12595614280,"speedPacketsRecv":3462,"speedPacketsSent":3462,"speedRecv":381088,"speedSent":381088}],"interface":[{"addrs":[{"addr":"127.0.0.1/8"}],"flags":["up","loopback"],"hardwareaddr":"","mtu":65536,"name":"lo"},{"addrs":[{"addr":"127.0.0.1/24"}],"flags":["up","broadcast","multicast"],"hardwareaddr":"52:54:00:18:c7:ff","mtu":1500,"name":"eth0"}],"netstat":{"close":0,"closeWait":29,"closing":0,"established":1723,"finWait1":0,"finWait2":3,"lastAck":0,"listen":33,"synRecv":0,"syncSent":0,"timeWait":1170},"protocolstat":{"udp":{"inCsumErrors":0,"inDatagrams":1553,"inErrors":0,"noPorts":0,"outDatagrams":1553,"rcvbufErrors":0,"sndbufErrors":0}}},"system":{"docker":{"Client":{"ApiVersion":"","GoVersion":"","Version":""},"Server":{"ApiVersion":"","GoVersion":"","Version":""}},"info":{"bootTime":1540266097,"hostid":"EC1F7341-45F3-4B9D-B138-6448EEA52BAD","hostname":"rbtnode1","kernelVersion":"3.10.0-693.el7.x86_64","os":"linux","platform":"centos","platformFamily":"rhel","platformVersion":"7.4.1708","procs":273,"systemtype":"64-bit","uptime":6308758,"virtualizationRole":"","virtualizationSystem":""}},"timezone":8,"utctime":"2019-01-04 04:08:20"},"dataid":1001,"gseindex":45816,"ip":"127.0.0.1","type":"basereport"}`
	snapshotData = `{"@timestamp":"2019-02-06T07:21:56.241Z","bkmonitorbeat":{"address":["127.0.0.1"],"hostname":"zk-2","name":"zk-2","version":"6.0.12"},"bizid":0,"cloudid":0,"dataid":2011,"gseindex":207499,"ip":"127.0.0.1","metricset":{"host":"127.0.0.1:9272","module":"prometheus","name":"collector","rtt":211344},"prometheus":{"collector":{"metrics":[{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"consul"},"value":6.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"fta"},"value":1.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"influxdb"},"value":2.000000},{"key":"consul_net_node_latency_p75","labels":{"consul_datacenter":"dc"},"value":5.124331},{"key":"consul_net_node_latency_median","labels":{"consul_datacenter":"dc"},"value":4.409470},{"key":"consul_net_node_latency_min","labels":{"consul_datacenter":"dc"},"value":0.335530},{"key":"consul_catalog_services_critical","labels":{"consul_datacenter":"dc","consul_node_id":"paas-1"},"value":3.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"job-direct"},"value":0.000000},{"key":"consul_net_node_latency_min","labels":{"consul_datacenter":"dc"},"value":0.252439},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"kafka"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"databus"},"value":2.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"monitor"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"fta"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"paas"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"es"},"value":0.000000},{"key":"consul_catalog_services_warning","labels":{"consul_datacenter":"dc","consul_node_id":"paas-1"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"paas-direct"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"paas"},"value":0.000000},{"key":"consul_net_node_latency_p99","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"kafka"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"dataapi"},"value":1.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"rabbitmq"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"mysql"},"value":1.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"beanstalk"},"value":1.000000},{"key":"consul_net_node_latency_p90","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb-direct"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"zk"},"value":0.000000},{"key":"consul_net_node_latency_max","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_net_node_latency_p75","labels":{"consul_datacenter":"dc"},"value":4.131547},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"paas"},"value":1.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"mongodb"},"value":3.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"beanstalk"},"value":0.000000},{"key":"consul_net_node_latency_median","labels":{"consul_datacenter":"dc"},"value":4.027523},{"key":"consul_net_node_latency_p75","labels":{"consul_datacenter":"dc"},"value":5.124331},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"appo"},"value":1.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"gse"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"dataapi"},"value":0.000000},{"key":"consul_catalog_services_passing","labels":{"consul_datacenter":"dc","consul_node_id":"nginx-1"},"value":10.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"ceph"},"value":0.000000},{"key":"consul_net_node_latency_p90","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"etcd"},"value":3.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"consul"},"value":0.000000},{"key":"consul_catalog_services_up","labels":{"consul_datacenter":"dc","consul_node_id":"zk-1"},"value":10.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"nfs"},"value":0.000000},{"key":"consul_net_node_latency_p25","labels":{"consul_datacenter":"dc"},"value":0.634718},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"kafka"},"value":3.000000},{"key":"consul_net_node_latency_p95","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_catalog_services_passing","labels":{"consul_datacenter":"dc","consul_node_id":"zk-1"},"value":10.000000},{"key":"consul_peers","labels":{"consul_datacenter":"dc","mode":"follower"},"value":3.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"redis_cluster"},"value":3.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"consul"},"value":6.000000},{"key":"consul_net_node_latency_p75","labels":{"consul_datacenter":"dc"},"value":4.409470},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"job"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"rabbitmq"},"value":0.000000},{"key":"consul_net_node_latency_p95","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"nfs"},"value":1.000000},{"key":"consul_catalog_services_critical","labels":{"consul_datacenter":"dc","consul_node_id":"nginx-1"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"redis"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"mysql"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"appo"},"value":1.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"paas-direct"},"value":1.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"dataapi"},"value":2.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb-direct"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"job-direct"},"value":1.000000},{"key":"consul_net_node_latency_p99","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_net_node_latency_p75","labels":{"consul_datacenter":"dc"},"value":4.354177},{"key":"consul_net_node_latency_max","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_net_node_latency_min","labels":{"consul_datacenter":"dc"},"value":0.245813},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"monitor"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"redis_cluster"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"zk"},"value":3.000000},{"key":"consul_net_node_latency_p25","labels":{"consul_datacenter":"dc"},"value":0.252439},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb"},"value":1.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"job-direct"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"appt"},"value":0.000000},{"key":"consul_net_node_latency_min","labels":{"consul_datacenter":"dc"},"value":0.371460},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"es"},"value":3.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"etcd"},"value":3.000000},{"key":"consul_net_node_latency_p90","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_net_node_latency_p90","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_net_node_latency_p99","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"redis"},"value":0.000000},{"key":"consul_catalog_services_up","labels":{"consul_datacenter":"dc","consul_node_id":"mysql-1"},"value":7.000000},{"key":"consul_net_node_latency_p95","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"redis_cluster"},"value":3.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"ceph"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"job"},"value":1.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"beanstalk"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"consul"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"nfs"},"value":1.000000},{"key":"consul_catalog_services_warning","labels":{"consul_datacenter":"dc","consul_node_id":"zk-3"},"value":0.000000},{"key":"consul_net_node_latency_max","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_net_node_latency_p99","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_net_node_latency_median","labels":{"consul_datacenter":"dc"},"value":4.027523},{"key":"consul_net_node_latency_p25","labels":{"consul_datacenter":"dc"},"value":0.325025},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"gse"},"value":1.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"fta"},"value":1.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"ceph"},"value":3.000000},{"key":"consul_catalog_services_critical","labels":{"consul_datacenter":"dc","consul_node_id":"zk-3"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"gse"},"value":1.000000},{"key":"consul_net_node_latency_min","labels":{"consul_datacenter":"dc"},"value":0.335530},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"databus"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb-direct"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb"},"value":0.000000},{"key":"consul_catalog_services_up","labels":{"consul_datacenter":"dc","consul_node_id":"zk-2"},"value":9.000000},{"key":"consul_net_node_latency_p95","labels":{"consul_datacenter":"dc"},"value":4.522797},{"key":"consul_net_node_latency_p99","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_net_node_latency_max","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_net_node_latency_p75","labels":{"consul_datacenter":"dc"},"value":4.466117},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"job"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"monitor"},"value":2.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"license"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"beanstalk"},"value":1.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"es"},"value":3.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb-direct"},"value":1.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"influxdb"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"paas-direct"},"value":1.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"mongodb"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"etcd"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"iam"},"value":0.000000},{"key":"consul_net_node_latency_p25","labels":{"consul_datacenter":"dc"},"value":0.325025},{"key":"consul_net_node_latency_p25","labels":{"consul_datacenter":"dc"},"value":0.371460},{"key":"consul_net_node_latency_p25","labels":{"consul_datacenter":"dc"},"value":0.634718},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"rabbitmq"},"value":1.000000},{"key":"consul_catalog_services_passing","labels":{"consul_datacenter":"dc","consul_node_id":"mysql-1"},"value":6.000000},{"key":"consul_net_node_latency_median","labels":{"consul_datacenter":"dc"},"value":4.466117},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"license"},"value":1.000000},{"key":"consul_net_node_latency_min","labels":{"consul_datacenter":"dc"},"value":0.245813},{"key":"consul_catalog_services_warning","labels":{"consul_datacenter":"dc","consul_node_id":"zk-1"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"appt"},"value":0.000000},{"key":"consul_catalog_services_passing","labels":{"consul_datacenter":"dc","consul_node_id":"paas-1"},"value":4.000000},{"key":"consul_catalog_services_warning","labels":{"consul_datacenter":"dc","consul_node_id":"mysql-1"},"value":0.000000},{"key":"consul_net_node_latency_p95","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"appo"},"value":0.000000},{"key":"consul_net_node_latency_median","labels":{"consul_datacenter":"dc"},"value":4.354177},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"appt"},"value":1.000000},{"key":"consul_catalog_services_critical","labels":{"consul_datacenter":"dc","consul_node_id":"mysql-1"},"value":1.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"redis"},"value":1.000000},{"key":"consul_catalog_services_up","labels":{"consul_datacenter":"dc","consul_node_id":"zk-3"},"value":9.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"iam"},"value":1.000000},{"key":"consul_net_node_latency_max","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"monitor"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"job-direct"},"value":0.000000},{"key":"consul_catalog_services_critical","labels":{"consul_datacenter":"dc","consul_node_id":"zk-1"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"databus"},"value":1.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"license"},"value":1.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"mysql"},"value":1.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"mysql"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"redis_cluster"},"value":0.000000},{"key":"consul_catalog_services_warning","labels":{"consul_datacenter":"dc","consul_node_id":"zk-2"},"value":0.000000},{"key":"consul_catalog_services_up","labels":{"consul_datacenter":"dc","consul_node_id":"paas-1"},"value":7.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"kafka"},"value":3.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"redis"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"es"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"paas-direct"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"rabbitmq"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"job"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"paas"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"influxdb"},"value":2.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"license"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"zk"},"value":3.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"databus"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"influxdb"},"value":0.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"mongodb"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"cmdb"},"value":1.000000},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"etcd"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"iam"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"zk"},"value":0.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"ceph"},"value":3.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"fta"},"value":0.000000},{"key":"consul_catalog_services_critical","labels":{"consul_datacenter":"dc","consul_node_id":"zk-2"},"value":0.000000},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"appt"},"value":1.000000},{"key":"consul_catalog_services_warning","labels":{"consul_datacenter":"dc","consul_node_id":"nginx-1"},"value":0.000000},{"key":"consul_net_node_latency_p90","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_net_node_latency_max","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"gse"},"value":0.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"dataapi"},"value":1.000000},{"key":"consul_catalog_services_passing","labels":{"consul_datacenter":"dc","consul_node_id":"zk-3"},"value":9.000000},{"key":"consul_catalog_nodes_up","labels":{"consul_datacenter":"dc","consul_service_id":"iam"},"value":1.000000},{"key":"consul_net_node_latency_p95","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_catalog_nodes_warning","labels":{"consul_datacenter":"dc","consul_service_id":"nfs"},"value":0.000000},{"key":"consul_net_node_latency_p90","labels":{"consul_datacenter":"dc"},"value":5.388478},{"key":"consul_catalog_nodes_passing","labels":{"consul_datacenter":"dc","consul_service_id":"mongodb"},"value":3.000000},{"key":"consul_catalog_services_up","labels":{"consul_datacenter":"dc","consul_node_id":"nginx-1"},"value":10.000000},{"key":"consul_catalog_nodes_critical","labels":{"consul_datacenter":"dc","consul_service_id":"appo"},"value":0.000000},{"key":"consul_catalog_services_passing","labels":{"consul_datacenter":"dc","consul_node_id":"zk-2"},"value":9.000000},{"key":"consul_net_node_latency_p99","labels":{"consul_datacenter":"dc"},"value":5.396917},{"key":"consul_net_node_latency_median","labels":{"consul_datacenter":"dc"},"value":4.131547}],"namespace":"consul_exporter"}},"type":"metricsets"}`
)

// BenchmarkMapContainerLoads_Snapshot :
func BenchmarkMapContainerLoads_Snapshot(b *testing.B) {
	benchmarkMapContainerLoads(b, consulData)
}

// BenchmarkMapContainerLoads_Consul :
func BenchmarkMapContainerLoads_Consul(b *testing.B) {
	benchmarkMapContainerLoads(b, snapshotData)
}

// BenchmarkMapContainerDumps_Snapshot :
func BenchmarkMapContainerDumps_Snapshot(b *testing.B) {
	benchmarkMapContainerDumps(b, consulData)
}

// BenchmarkMapContainerDumps_Consul :
func BenchmarkMapContainerDumps_Consul(b *testing.B) {
	benchmarkMapContainerLoads(b, snapshotData)
}
